package com.Ecomm.pages;

import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.By;
import java.time.Duration;
import java.util.List;

public class CartPage {
	 private WebDriver driver;
	    private WebDriverWait wait;
	    
	    // Web elements using Page Factory
	    @FindBy(xpath = "//div[contains(@class,'cart-item') or contains(@class,'cart-product')]")
	    private List<WebElement> cartItems;
	    
	    @FindBy(xpath = "//button[contains(text(),'Remove') or contains(@class,'remove')]")
	    private List<WebElement> removeButtons;
	    
	    @FindBy(xpath = "//input[contains(@class,'quantity') or @name='quantity']")
	    private List<WebElement> quantityFields;
	    
	    @FindBy(xpath = "//span[contains(@class,'total') or contains(@class,'cart-total')]")
	    private WebElement cartTotal;
	    
	    @FindBy(xpath = "//div[contains(@class,'empty-cart') or contains(text(),'empty')]")
	    private WebElement emptyCartMessage;
	    
	    // Constructor
	    public CartPage(WebDriver driver) {
	        this.driver = driver;
	        this.wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        PageFactory.initElements(driver, this);
	    }
	    
	    // Methods
	    public boolean isProductInCart(String productName) {
	        try {
	            WebElement product = driver.findElement(By.xpath("//div[contains(@class,'cart-item')]//span[contains(text(),'" + productName + "') or contains(@title,'" + productName + "')] | " +
	                                                             "//div[contains(@class,'cart-product')]//*[contains(text(),'" + productName + "')]"));
	            return product.isDisplayed();
	        } catch (Exception e) {
	            return false;
	        }
	    }
	    
	    public String getProductQuantity(String productName) {
	        try {
	            WebElement productRow = driver.findElement(By.xpath("//div[contains(@class,'cart-item') and .//span[contains(text(),'" + productName + "')]] | " +
	                                                                "//tr[contains(@class,'cart-item') and .//span[contains(text(),'" + productName + "')]]"));
	            WebElement quantityElement = productRow.findElement(By.xpath(".//input[contains(@class,'quantity')] | .//span[contains(@class,'quantity')]"));
	            
	            if (quantityElement.getTagName().equals("input")) {
	                return quantityElement.getAttribute("value");
	            } else {
	                return quantityElement.getText();
	            }
	        } catch (Exception e) {
	        	
	        