package com.Ecomm.utilities;

import java.io.File;


import java.io.FileInputStream;
import java.io.IOException;

import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelUtilities {
	public static Object[][] getdata(String excelpath, String sheetname) throws IOException {
	    File file1 = new File(excelpath);
	    FileInputStream fs = new FileInputStream(file1);
	    XSSFWorkbook workbook = new XSSFWorkbook(fs);
	    XSSFSheet worksheet = workbook.getSheet(sheetname);

	    int rowcount = worksheet.getPhysicalNumberOfRows();
	    int colcount = worksheet.getRow(0).getLastCellNum();  // detect number of columns
	    
	    System.out.println("rows: " + rowcount + " cols: " + colcount);

	    String[][] data = new String[rowcount][colcount];   // <-- dynamic rows & columns

	    for (int i = 0; i < rowcount; i++) {
	        for (int j = 0; j < colcount; j++) {
	            if (worksheet.getRow(i) != null && worksheet.getRow(i).getCell(j) != null) {
	                data[i][j] = worksheet.getRow(i).getCell(j).toString();
	            } else {
	                data[i][j] = ""; // blank cell handling
	            }
	        }
	    }
		  
		  return data;
		  
		 	    };
}